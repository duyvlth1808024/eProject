<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
<title>Home</title>
<!-- fonts -->
<link href="https://fonts.googleapis.com/css?family=Sarabun" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Coiny" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Charm" rel="stylesheet">
<!-- icons -->
<link rel="stylesheet" type="text/css" href="FontAwesome/css/all.css">
<!-- styles -->
<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="vendor/owlcarousel2/owl.carousel.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="vendor/owlcarousel2/owl.theme.default.css">
<link rel="stylesheet" type="text/css" href="styles.css">
<!-- javascript -->
<script type="text/javascript" src="vendor/jquery/jquery.js"></script>
<script type="text/javascript" src="vendor/bootstrap/js/bootstrap.js"></script>
<script type="text/javascript" src="vendor/owlcarousel2/owl.carousel.js"></script>
<script type="text/javascript" src="javascript.js"></script>
</head>
<body>
     <div id="myModal"  class="modal fade z-index2" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">This is Modal</h4>
      </div>
      <div class="modal-body">
        <p>Modal body</p>
      </div>
      <div class="modal-footer">

        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <a href="gio_hang.html" type="button" class="btn btn-primary">chi tiết</a>
      </div>
   </div>
  </div>
</div>
   <!--  =============
  
        
    </div> -->
<header class="col-lg-12">
    <div class="navigation">
        <div class="col-lg-2 navigation-left">
            <a href="#" class="logo-header">
                <span>L</span>
                <span>a</span>
                <span>_</span>
                <span>I</span>
                <span>m</span>
                <span>p</span>
                <span>e</span>
                <span>r</span>
                <span>i</span>
                <span>a</span>
                <span>l</span>                  
            </a>
        </div>
        <div class="col-lg-8 navigation-center">
            <a href="/" class="active-navigation">Home</a>
            <a href="#">Product List</a>
            <a href="Contact.html">Contact</a>
            <a href="#">Support</a>
            <a href="#"></i> Store Location</a>
        </div>
        <div class="col-lg-2 navigation-right">
            <a href="#" id="cdsearch"><i id="ffst" class="far fa-search"></i></a>
            <a href="#"data-toggle="modal" data-target="#exampleModal"><i class="far fa-user"></i></a>
            <a href="#"data-toggle="modal" data-target="#myModal" ><i class="far fa-shopping-cart"></i></a>
</button>
        </div>
    </div>
    <div id="search-box" class="search-box">
        <div class="container">
            <div class="searching-box">
                <i id="ffct" class="fal fa-times"></i>
                <input type="text" placeholder="Search">
                <button><i class="far fa-search"></i></button>
            </div>  
        </div>
    </div>
 <!--    //dang ky-dang nhap -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Login to La_Imperial</h4>
                </div>
                <div class="modal-body">
                    <form class="form-login" id="form-login" action="/login" method="post" name="form_data" enctype="multipart/form_data">
                        <div class="login user">
                            <input type="text" name="email" required>
                            <i class="fa fa-user"></i>
                            <label>Email or Username</label>                    
                        </div>
                        <div class="login password">
                            <input type="password" name="password" required>
                            <i class="fa fa-lock"></i>
                            <label>Password</label>
                        </div>
                    
                    <div class="remember-box">
                        <a href="/signup">Create new account</a>

                </div>
                <div class="modal-footer">
                    <a href="#">Forget password</a>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" onclick="return checkRegister()">Login</button>
                </form>
                </div>
            </div>
        </div>
    </div>
    <!-- <div class="cart-navigation">
        
    </div> -->
</header>
<section class="col-lg-12 section-slider">
    <div class="container">
        <div class="owl-carousel owl-theme">
            <div class="item">
                <div class="col-lg-7 information-slider">
                    <h1>Product 1</h1>
                    <span>try 123 123 rwerw 1`312 3121 241241 241231 23</span>
                    <h2>120$</h2>
                    <button>add to cart</button>
                </div>
                <div class="col-lg-5 img-slider">
                    <img src="images/den-chum.png">
                </div>
            </div>
            <div class="item">
                <div class="col-lg-7 information-slider">
                    <h1>Product 2</h1>
                    <span>try 123 123 rwerw 1`312 3121 241241 241231 23</span>
                    <h2>120$</h2>
                    <button>add to cart</button>
                </div>
                <div class="col-lg-5 img-slider">
                    <img src="images/den-chum.png">
                </div>
            </div>
        </div>
    </div>
</section>

<section class="col-lg-12 benefits">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 box-benefit">
                <div class="col-lg-3 icon-benefit">
                    <i class="far fa-truck"></i>
                </div>
                <div class="col-lg-9 information-benefit">
                    <h4>Free Ship</h4>
                    <span>with orders from 100$ or more</span>
                </div>
            </div>
            <div class="col-lg-3 box-benefit">
                <div class="col-lg-3 icon-benefit">
                    <i class="far fa-undo"></i>
                </div>
                <div class="col-lg-9 information-benefit">
                    <h4>Exchange Products</h4>
                    <span>free in 7 days</span>
                </div>
            </div>
            <div class="col-lg-3 box-benefit">
                <div class="col-lg-3 icon-benefit">
                    <i class="far fa-clock"></i>
                </div>
                <div class="col-lg-9 information-benefit">
                    <h4>Time Working</h4>
                    <span>7:30 AM to 8:00 PM</span>
                </div>
            </div>
            <div class="col-lg-3 box-benefit">
                <div class="col-lg-3 icon-benefit">
                    <i class="far fa-tools"></i>
                </div>
                <div class="col-lg-9 information-benefit">
                    <h4>Fit up</h4>
                    <span>free with orders from 100$ or more</span>
                </div>
            </div>
        </div>
    </div>
</section>
 <section class="section1">
            <div class="container">
            <div class="col-lg-12 iteam_hot">
                <h2>SẢN PHẨM HOT</h2>
            </div>
                
                <div class="row"  id="san_pham">
                    <span></span>

            </div>
</section>
<section class="section1">
            <div class="container">
            <div class="col-lg-12 iteam_hot">
                <h2>DETAIL</h2>
            </div>
                
                <div class="row"  id="detail_product">
                    <span></span>

            </div>
</section> 
<section class="section3">
    <div class="container">
         <div class="row">
            <table class="table table-bordered" id="table-products">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div>
            <button class="btn btn-lg btn-success" id="button-clear">Clear</button>
        </div>
    </div>
</section>
<section class="section4">
    <div class="container">
         <div class="row">
            <table class="table table-bordered" id="table_products">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>
            </table>
        </div>
        <div>
            <button class="btn btn-lg btn-success" id="button_clear">Clear</button>
        </div>
    </div>
</section>
<section class="section2">
            <div class="container">
            <div class="col-lg-12 iteam_hot">
                <h2>SẢN PHẨM MỚI</h2>
            </div>
                
            
                <div class="row">
                    <div class="col-lg-3">
                        <div class="item item1">
                    <img src="images/anh2.png"/>
                    <p><a href="#" title="Reebok Track Jacket">Reebok Track Jacket</a></p>
                    <a href="#" class="btn btn-primary">thêm</a>
                    <p><b><font color="#ff5912">100$</font></b></p>
                    </div>
                    </div>
                <div class="col-lg-3">
                <div class="img-thumbnail" style="border: 1px solid gray; width: 100%; height: 160px"></div>
                <div>
                    iPhone 6 Plus
                </div>
                <div>
                    Giá: 17.000.000đ
                </div>
                <button data_id="product-1" data-name='iPhone 6 Plus' data-price="17000000" class="add-to-cart btn btn-primary">Add to cart</button>
            </div>
                    
                </div>
            </div>
            </div>
</section> 
<section class="col-lg-12 newsletter">
    <div class="container">
        <div class="row rownl">
            <div class="col-lg-6">
                <h3>Newsletter</h3>
                <span>Join us now to get all news with special offers and get 20% off your first purchase</span>
            </div>
            <div class="col-lg-6">
                <form action="post">
                    <input type="email" placeholder="Your email" id="email_newsletter">
                    <button id="submit_newsletter">Subcribe</button>
                </form>
            </div>
        </div>
    </div>
</section>
<footer class="col-lg-12">
    <div class="col-lg-12 footer-top">
        <div class="container">
            <div class="col-lg-3 logo-footer">
                <span class="logo-text">
                    L a _ I m p e r i a l
                </span>
                <span><b>A &ensp;</b> Số 7 Tôn Thất Thuyết, Mỹ Đình, Hà Nội</span>
                <span><b>T &ensp;</b> +84 123 456 789</span>
                <span><b>M &ensp;</b> 123456@fpt.edu.vn</span>
            </div>
            <div class="col-lg-6">
                
            </div>
            <div class="col-lg-3 payment-method">
                <span>Payment Method</span>
                <i class="fab fa-cc-mastercard"></i>
                <i class="fab fa-cc-visa"></i>
                <i class="fab fa-cc-amazon-pay"></i>
                <i class="fab fa-cc-stripe"></i>
                <i class="fab fa-cc-paypal"></i>
                <i class="fab fa-cc-jcb"></i>
                <i class="fab fa-cc-discover"></i>
                <i class="fab fa-cc-diners-club"></i>
                <i class="fab fa-cc-apple-pay"></i>
                <i class="fab fa-cc-amex"></i>
                <i class="fab fa-cc-amazon-pay"></i>
            </div>
        </div>
    </div>
    <div class="col-lg-12 footer-bottom">
        <div class="container">
            <div class="col-lg-6 coppyright">
                <span>Coppyright © 2018 Farost</span>
            </div>
            <div class="col-lg-6 page-store">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-google-plus-g"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>
</footer>
<script>

        var owl = $('.owl-carousel');
        owl.owlCarousel({
            items:1,
            nav:true,
            dots:false,
            loop:true,
            margin:10,
            autoplay:true,
            autoplayTimeout:5000,
            autoplayHoverPause:false
        });

     
    function list_product_all(){
    jQuery.ajax({
        url: '/list_product',
        method: "GET",
        success: function(result, element){
            var y = '';
            for (var i = 0; i < result.data.length; i++){
                y+='    <div class="col-lg-3">';
                y+='    <div class="item item1">';
                y+='    <img src='+result.data[i].pr_images1+' ';
                y+='    <p><a href="/chi_tiet_san_pham.html?id='+result.data[i]._id+'" title='+result.data[i].pr_name+'>'+result.data[i].pr_name+'</a></p>';
                y+='    <p><b><font color="#ff5912">'+result.data[i].pr_price+'</font></b></p>';
                y+='   <button data-id="'+result.data[i].pr_code+'" data-name="'+result.data[i].pr_name+'" data-price="'+result.data[i].pr_price+'" class="add-to-cart btn btn-primary" > Add to cart</button>';
                y +='   <a data_id="'+result.data[i]._id+'" class="btn btn-danger" onclick="gio_hang(this)">Add to cart2 </a>';
                y+='    </div>';
                y+='    </div>';
            }

            document.getElementById("san_pham").innerHTML = y;
        }
    });
    }
    list_product_all();


           // ==================================================
            $("#button_clear").click(function () {
                shoppingCartItems = [];
                sessionStorage["shopping-cart-items"] = JSON.stringify(shoppingCartItems);
                $("#table_products > tbody").html("");
            });
        // ==============================================
         function gio_hang(id){
            jQuery.ajax({
                url: '/detail_product',
                method: "GET",
                data: {id: jQuery(id).attr("data_id")},
                success: function(result){
                    var button = $(this);
                    var id = +result.data.pr_code+; // id của sản phẩm là id của button
                    var name = +result.data.pr_name+; // name của sản phẩm là data-name của button
                    var price = +result.data.pr_price+; // price của sản phẩm là data-price của button
                    var quantity = 1; // Số lượng
               
                var quantity = 1;
                var s = '';
                {
                s+= '<tr>';
                s+= '<td>' +result.data.pr_code+'</td>';
                s+= '<td>' +result.data.pr_name+ '</td>';
                s+= '<td>' +result.data.pr_price+ '</td>';
                s+= "<td style='text-align: right'>" + quantity + "</td>";
                s+= "<td style='text-align: right'>" + result.data.pr_price * quantity + "</td>";
                s+= '</tr>';
                }
                $("#table_products > tbody:last").append(s);
        }
    });
    }

         //==================================================
        // Định nghĩa một mảng các phần tử sẽ bỏ vào giỏ hàng
    var shoppingCartItems = [];

    $(document).ready(function () {
        // Kiểm tra nếu đã có sessionStorage["shopping-cart-items"] hay chưa?
        if (sessionStorage["shopping-cart-items"] != null) {
            shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString());
        }

        // Hiển thị thông tin từ giỏ hàng
        displayShoppingCartItems();
    });


        // Sự kiện click các button có class=".add-to-cart"

        $(".add-to-cart").bind('click',function (){
        
        var button = $(this);
        console.log(button) // Lấy đối tượng button mà người dùng click
        var id = button.attr("data-id"); // id của sản phẩm là id của button
        var name = button.attr("data-name"); // name của sản phẩm là data-name của button
        var price = button.attr("data-price"); // price của sản phẩm là data-price của button
        var quantity = 1; // Số lượng


        var item = {
            id: id,
            name: name,
            price: price, 
            quantity: quantity
        };

        console.log(item);

        var exists = false;
        if (shoppingCartItems.length > 0) {
            $.each(shoppingCartItems, function (index, value) {
                // Nếu mặt hàng đã tồn tại trong giỏ hàng thì chỉ cần tăng số lượng mặt hàng đó trong giỏ hàng.
                if (value.id == item.id) {
                    value.quantity++;
                    exists = true;
                    return false;
                }
            });
        }

        // Nếu mặt hàng chưa tồn tại trong giỏ hàng thì bổ sung vào mảng
        if (!exists) {
            shoppingCartItems.push(item);
        }

        // Lưu thông tin vào sessionStorage
        sessionStorage["shopping-cart-items"] = JSON.stringify(shoppingCartItems); // Chuyển thông tin mảng shoppingCartItems sang JSON trước khi lưu vào sessionStorage
        // Gọi hàm hiển thị giỏ hàng
        displayShoppingCartItems();
    });
          // Xóa hết giỏ hàng shoppingCartItems
    $("#button-clear").click(function () {
        shoppingCartItems = [];
        sessionStorage["shopping-cart-items"] = JSON.stringify(shoppingCartItems);
        $("#table-products > tbody").html("");
    });

    // Hiển thị giỏ hàng ra table
    function displayShoppingCartItems() {
        if (sessionStorage["shopping-cart-items"] != null) {
            shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString()); // Chuyển thông tin từ JSON trong sessionStorage sang mảng shoppingCartItems.

            $("#table-products > tbody").html("");
            // Duyệt qua mảng shoppingCartItems để append từng item dòng vào table
            $.each(shoppingCartItems, function (index, item) {
                var htmlString = "";
                htmlString += "<tr>";
                htmlString += "<td>" + item.id + "</td>";
                htmlString += "<td>" + item.name + "</td>";
                htmlString += "<td style='text-align: right'>" + item.price + "</td>";
                htmlString += "<td style='text-align: right'>" + item.quantity + "</td>";
                htmlString += "<td style='text-align: right'>" + item.price * item.quantity + "</td>";
                htmlString += "</tr>";
                $("#table-products > tbody:last").append(htmlString);

            });
        }
    }

   
    //  function gio_hang(id){
    //         jQuery.ajax({
    //             url: '/detail_product',
    //             method: "GET",
    //             data: {id: jQuery(id).attr("data_id")},
    //             success: function(result){

    //             var s = '';
    //             {
    //             s+= '<tr>';
    //             s+= '<td>' +result.data.pr_code+'</td>';
    //             s+= '<td>' +result.data.pr_name+ '</td>';
    //             s+= '<td>' +result.data.pr_price+ '</td>';
    //             s+= '</tr>';
    //             }
    //             // jQuery("table_products tbody").append(s);
    //             // const div = document.getElementById("table_products");
    //             //         div.insertAdjacentHTML('beforeend', 'stuff');
    //         document.getElementById("table_products").innerHTML = s;
    //     }
    // });
    // }
</script>
</body>
</html>